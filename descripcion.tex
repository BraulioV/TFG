\chapter{Descripción del sistema y requisitos}

% \section{Descripción del sistema}

% La idea general del sistema es ofrecer una forma automatizada de hacer los horarios de una escuela o facultad en base a restricciones tales como el profesorado y su disponibilidad, las aulas disponibles teniendo en cuenta su capacidad y el equipo del que disponen, el número de alumnos de una asignatura, bloques horarios, etc. 

% Con este sistema podrán estudiarse distintas propuestas de horarios para maximizar el uso de las aulas, el rendimiento de todo el equipo de una facultad y facilitar el trabajo que supone la creación de un horario para cada nuevo curso.

% \section{Objetivos principales del sistema}

% \begin{enumerate}[OBJ-1]
%     \item El usuario debe introducir la menor información posible para que le resulte más cómodo y sencillo hacer uso del sistema. Esto sería posible si la mayoría de información necesaria para la generación del horario fuera posible obtenerla de la base de datos de la escuela o de la UGR, para evitar que el usuario tenga que realizar ninguna entrada desde ficheros o similares.
    
%     \item Tener la posibilidad de realizar un nuevo horario desde cero a partir de los datos disponibles, y la posibilidad de, a partir de uno ya generado, generar uno nuevo a partir de modificaciones.

%     \item Sobre la solución del sistema, existen dos opciones:
%     \begin{enumerate}[a)]
%         \item Ofrecer una única solución y ofrecer la posibilidad de realizar modificaciones sobre esta de forma interactiva y que el sistema avise de posibles conflictos.
%         \item Ofrecer como salida un parapeto de soluciones que haya encontrado el sistema y que el usuario final elija entre las soluciones que más le interesen.
%     \end{enumerate}
%     % \item Poder conectarse a las bases de datos de la universidad de forma que el usuario introduzca la menor información posible.
%     % \item Poder crear un horario válido desde cero usando los datos disponibles.
%     % \item Una vez hecha una propuesta de horario, realizar modificaciones sobre la misma de forma que se obtenga un horario válido.
% \end{enumerate}

\section{Requisitos del sistema}

\begin{enumerate}[REQ-1]
    \item No pueden solaparse dos asignaturas el mismo día y a la misma hora en el mismo aula.
    \item Cómo máximo hay tres subgrupos de prácticas. Puede haber asignaturas en las que haya dos subgrupos y otras en las que haya sólo uno.
    \item Para cada grupo de teoría se debe de decidir de forma manual su franja horaria, es decir, qué horario tendrá, y el aula de teoría que se le quiere asignar a ese grupo.
    \item No puede haber más de tres grupos de teoría asignados al mismo aula en el mismo turno (mañana o tarde), pudiendo convivir de uno a tres grupos. 
    \item Se debe saber de antemano el número de horas de teoría y prácticas de cada asignatura.
    \item Si el número de horas de teoría o prácticas de una asignatura es impar, se agrupará con otra asignatura que esté en la misma situación, generando un ``bloque''. Esto puede generar un problema en la generación del horario y es que puede ser que alguna hora de una asignatura sea imposible cuadrarla en el horario con las demás, por lo que esta hora se añadirá al principio o al final del turno ofreciendo la posibilidad de cambiarla manualmente. Esta situación se puede evitar si las horas de prácticas y/o teoría las imparten profesores diferentes.
    \item Se debe dar la posibilidad de para una asignatura, elegir si impartir las horas de teoría en un mismo turno de dos o más horas, o repartir las sesiones de teoría a lo largo de la semana en días distintos.
    \item El horario obtenido para cada grupo no debe de contener huecos, es decir, debe ser lo más compacto posible.
    \item Las distintas especialidades tienen su horario en paralelo para no favorecer ninguna especialidad sobre otra.
    \item Se debe registrar el equipamiento disponible en cada laboratorio y el que cada asignatura necesita para llevar a cabo sus prácticas de forma que el sistema realice la asignación a laboratorios de forma automática en función del equipamiento que tiene el aula y del que necesita la asignatura. 
    \item Se debe poder elegir el número de días y la franja horaria para cada titulación por separado. 
    \item Se debe dar la posibilidad de incluir restricciones fuertes de horas y días para ciertas titulaciones, como es el caso del Doble Grado en Ingeniería Informática y Matemáticas, donde su horario puede ocupar una franja completa ($8:30-14:30$).
    \item Se necesita saber el número de horas que tendrán las aulas para cuadrar los horarios.
\end{enumerate}

\section{Interacción de los distintos elementos}

A partir de los requisitos que hemos extraído, vemos que hay cuatro elementos fundamentales que interaccionan entre sí:

\begin{enumerate}[---]
    \item \textbf{Grupo}: define los distintos grupos que hay para cursar cada curso.
    \item \textbf{Aula de teoría}: define las distintas aulas de teoría disponibles.
    \item \textbf{Aula de prácticas}: define los distintos laboratorios de prácticas, junto al \textbf{material} del que disponen.
    \item \textbf{Asignatura}: define las distintas asignaturas que se imparten en cada curso.
\end{enumerate}

\begin{figure}[!h]
    \centering
    \input{interaccion.tex}
    \caption{Interacción de los diferentes elementos del sistema}
    \label{interaccion}
\end{figure}

En la \hyperref[interaccion]{Figura \ref*{interaccion}} vemos un esquema de la interacción de los diferentes elementos del sistema entre sí. El primer paso que daría el usuario sería asignar manualmente a cada grupo su correspondiente aula de teoría. En primer lugar, el sistema debe comprobar si la asignación ha que ha hecho el sistema es \textbf{realizable}, consultando el número de horas de teoría que tiene ese grupo. En caso de que la asignación sea irealizable, el usuario deberá corregirla y si la asignación ha sido correcta, el sistema empezaría a trabajar. La principal labor que debe hacer es asignar a cada grupo de prácticas una hora y un laboratorio, siguiendo la restricción de que hay asignaturas que necesitan un material concreto. 

Para cuadrar las horas de forma eficiente pensamos que es necesario una estructura de datos adicional (una tabla hash o un diccionario) en el que se vaya llevando la cuenta de las aulas que se asignan y cuándo se asignan. Además, al tratarse algo que se va construyendo poco a poco, hemos pensado que podemos usar alguna variante del algoritmo de \textit{Colonia de Hormigas}.

\begin{figure}[!h]
    \centering
    \input{clases.tex}
    \caption{Diagrama que representa cada uno de los elementos esenciales del sistema junto con la información que almacenan}
    \label{clases}
\end{figure}

A partir del diagrama de interacción (\hyperref[interaccion]{Figura \ref*{interaccion}}) hemos extraído una serie de clases que representan cada uno de los elementos junto con la información que deben almacenar. Dicho diagrama está representado en la \hyperref[clases]{Figura \ref*{clases}} y destacamos los siguientes aspectos:

\begin{enumerate}[$\bullet$]
    \item El elemento \textit{Aula de teoría} está representado por la clase \textit{Aula}, que almacena la capacidad de la misma y su nombre. El elemento \textit{Aula de prácticas} es una especialización de la clase \textit{Aula}, que además almacena el material del que dispone ese laboratorio. Para representar este material, hemos optado por usar un \texttt{string} aunque no descartamos la posibilidad de usar un \texttt{struct} si vemos que necesitamos almacenar información adicional para caracterizar los distintos materiales que puede haber en un laboratorio.

    \item El atributo referente al \textit{número de subgrupos de prácticas} está colocado tanto en la clase \textit{Grupo} como en la clase \textit{Asignatura} porque no sabemos dónde correspondería. Es decir, la idea es que tras un breve análisis podamos ponernos de acuerdo. Los argumentos para poner ese atributo en cada clase son:
    \begin{enumerate}[---]
        \item \textbf{Grupo}: cada grupo tiene un número distinto de alumnos. Por ejemplo, el grupo A de una asignatura puede tener 100 matriculados y el grupo F, 50. Por tanto al grupo A le corresponderían 3 grupos de prácticas mientras que al F sólo 2.
        \item \textbf{Asignatura}: cada asignatura de un mismo grupo puede tener un número distinto de alumnos matriculados: no es lo mismo una asignatura obligatoria que una asignatura optativa. Además, al hacer el horario no sabemos el número de alumnos matriculados sino las plazas ofertadas, y en caso de no llenar todas las plazas, siempre está la opción de corregir el horario manualmente.
    \end{enumerate}
\end{enumerate} 
